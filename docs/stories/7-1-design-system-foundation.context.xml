<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>7</epicId>
    <storyId>1</storyId>
    <title>Design System Foundation</title>
    <status>drafted</status>
    <generatedAt>2025-11-04</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/7-1-design-system-foundation.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>frontend developer</asA>
    <iWant>to set up the shadcn-svelte design system with SpendSense design tokens</iWant>
    <soThat>I have a consistent foundation for building the calm, focused interface</soThat>
    <tasks>See full AC list in story file - 10 detailed acceptance criteria covering shadcn setup, Tailwind tokens, fonts, core components (Button, Card, Input, Select, Badge, Alert, Tabs, Tooltip, Dialog, Table, Progress), and 3 custom components (KpiCard, RecommendationCard, PersonaBadge)</tasks>
  </story>

  <acceptanceCriteria>
1. Install shadcn-svelte (bunx shadcn-svelte@latest init)
2. Configure Tailwind CSS with SpendSense design tokens (colors, spacing, shadows, border-radius)
3. Add Inter font family for UI (weights: 400, 500, 600)
4. Add JetBrains Mono for financial data/numbers
5. Install 11 core shadcn components (Button, Card, Input, Select, Badge, Alert, Tabs, Tooltip, Dialog, Table, Progress)
6. Create lib/components/ui/ directory structure
7. Create KpiCard.svelte component (label, value, change, variant props)
8. Create RecommendationCard.svelte component (icon, title, body, rationale, cta props)
9. Create PersonaBadge.svelte component (personaName, description, confidence props)
10. Verify components render with generous spacing (32px card padding)
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <artifact>
        <path>docs/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>Complete design system</section>
        <snippet>Full color palette, typography, spacing system, component anatomy for KPI cards, recommendation cards, persona badges. Generous spacing (32px padding), subtle shadows, Inter + JetBrains Mono fonts.</snippet>
      </artifact>

      <artifact>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 7.1 (lines 1536-1577)</section>
        <snippet>shadcn-svelte setup, Tailwind v4 config, design tokens, core components, 3 custom components with detailed anatomy and states.</snippet>
      </artifact>
    </docs>

    <code>
      <artifact>
        <path>spendsense-frontend/tailwind.config.js</path>
        <kind>config</kind>
        <symbol>tailwind configuration</symbol>
        <lines>N/A</lines>
        <reason>Extend with SpendSense colors, spacing (18, 22), shadows (subtle, soft), border-radius values per UX spec.</reason>
      </artifact>

      <artifact>
        <path>spendsense-frontend/src/lib/components/</path>
        <kind>directory</kind>
        <symbol>component directory</symbol>
        <lines>N/A</lines>
        <reason>Create ui/ subdirectory for shadcn components, custom components at this level (KpiCard, RecommendationCard, PersonaBadge).</reason>
      </artifact>
    </code>

    <dependencies>
      <npm>
        <package name="shadcn-svelte" version="latest">Svelte 5 + Tailwind v4 compatible component library</package>
        <package name="tailwindcss" version="4.x (next)">CSS framework with design tokens</package>
        <package name="@tailwindcss/vite" version="next">Tailwind Vite plugin</package>
      </npm>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint type="design">
      <rule>Follow UX spec exactly: generous spacing (32px card padding), subtle shadows, calm colors, Inter + JetBrains Mono fonts</rule>
      <source>docs/ux-design-specification.md</source>
    </constraint>

    <constraint type="framework">
      <rule>Svelte 5 runes ($state, $derived) - no legacy stores. Tailwind v4 syntax (no @apply directives)</rule>
      <source>docs/architecture.md</source>
    </constraint>
  </constraints>

  <interfaces>
    <interface>
      <name>KpiCard Component</name>
      <kind>svelte_component</kind>
      <signature>Props: label (string), value (string), change (string), variant ('standard'|'featured'|'alert'|'success')</signature>
      <path>spendsense-frontend/src/lib/components/KpiCard.svelte (to create)</path>
      <description>KPI display card with uppercase label, large value, optional change indicator. Featured variant spans 2x width in grid.</description>
    </interface>

    <interface>
      <name>RecommendationCard Component</name>
      <kind>svelte_component</kind>
      <signature>Props: icon (string), title (string), body (string), rationale (string), cta (string)</signature>
      <path>spendsense-frontend/src/lib/components/RecommendationCard.svelte (to create)</path>
      <description>Recommendation display with 40px icon circle, badge, title, body, gray-50 rationale box, CTA button. States: default, hover (blue border), expanded.</description>
    </interface>

    <interface>
      <name>PersonaBadge Component</name>
      <kind>svelte_component</kind>
      <signature>Props: personaName (string), description (string), confidence (number)</signature>
      <path>spendsense-frontend/src/lib/components/PersonaBadge.svelte (to create)</path>
      <description>Persona display with gradient avatar (blueâ†’green), semibold name, subtext description, confidence percentage.</description>
    </interface>
  </interfaces>

  <tests>
    <standards>
      Visual verification:
      1. Run bun run dev and verify dev server starts
      2. Create test page importing all 3 custom components
      3. Verify generous spacing (32px padding visible)
      4. Check fonts load (Inter for text, JetBrains Mono for numbers)
      5. Verify colors match UX spec
      6. Test component variants and states
    </standards>

    <locations>
      <location type="components">spendsense-frontend/src/lib/components/ui/ (shadcn)</location>
      <location type="custom_components">spendsense-frontend/src/lib/components/*.svelte</location>
      <location type="config">spendsense-frontend/tailwind.config.js</location>
    </locations>

    <ideas>
      <test id="AC1-5" criteria="Setup and configuration">
        Verify shadcn init succeeded.
        Check Tailwind config has all custom colors, spacing, shadows.
        Verify Inter and JetBrains Mono fonts load in browser DevTools.
        Check all 11 core components installed in ui/ directory.
      </test>

      <test id="AC6-10" criteria="Custom components">
        Test KpiCard renders with all 4 variants.
        Test RecommendationCard shows icon, rationale, CTA.
        Test PersonaBadge displays gradient avatar and confidence.
        Verify 32px padding visible on cards.
        Check hover states work (blue border on recommendation cards).
      </test>
    </ideas>
  </tests>
</story-context>
